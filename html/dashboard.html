<!DOCTYPE html>
<style>

</style>
<html>

<head>
    <title>
        Dashboard
    </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript">
    </script>







</head>

<body style = "background: linear-gradient(to top left, #003366 0%, #ff9999 100%) fixed">
    <div class="container">
        <div class="col-sm-12" style="text-align:right">
            <img src="/uploads/logol.jpg"  class = "img-rounded" style="float:left;height:100px;width:300px;margin-left:-60px" />

            <div id="logout" style="padding-top:10px">
                <br>

            </div>
        </div>
    </div>
    <nav class="navbar navbar-inverse">
        <div class="container-fluid">

            <ul class="nav navbar-nav">
                <li class="active"><a href="/html/dashboard.html">Dashboard</a></li>
                <li><a href="/html/leads.html">Leads</a></li>
                <li><a href="/html/enquiry2.html">Create New Enquiry</a></li>
                <li><a href="/html/prospect.html">Prospects</a></li>
                <li><a href="/html/payment.html">Payment</a></li>
                <li><a href="/html/query.html">Query</a></li>
                <li><a href="/html/compare.html">Compatibility Match</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="col-sm-2">
            <div id="afterlogin">
                <br>
                <p><b>Leads </b><span id="countleads" class="badge"></span></p>
                <p><b>Prospects </b><span id="countprospects" class="badge"></span></p>
                <p><b>Walk-in </b><span id="no_of_walkin" class="badge"></span></p>
                <p><b>Call-in </b><span id="no_of_callin" class="badge"></span></p>
                <p><b>Paid Members </b><span id="paid_members" class="badge"></span></p>

            </div>

        </div>

        <div class="col-sm-10">
            <h4 style="text-decoration:underline"><b>Today's Appointments</b></h4>
            <div style="height:195px;overflow:auto;background-color: aliceblue">
                <table class="table table-condensed">

                    <thead style="background-color:darkgrey">
                        <tr>
                            <th>ID</th>
                            <th>Type</th>
                            <th>Contact No</th>
                            <th>Contact Date</th>
                            <th>Call-in Update</th>
                            <th>Walk-in Update</th>
                            <th>Stage</th>
                            <th>Print Profie</th>

                        </tr>
                    </thead>
                    <tbody id='appoint'>

                    </tbody>

                </table>
            </div>
            <h4 style="text-decoration:underline"><b>Today's Follow-ups</b></h4>
            <div style="height:195px;overflow:auto;background-color: azure">
                <table class="table table-condensed">

                    <thead style="background-color:darkgray">
                        <tr>
                            <th>ID</th>
                            <th>Type</th>
                            <th>Contact No</th>
                            <th>Contact Date</th>
                            <th>Call-in Update</th>
                            <th>Walk-in Update</th>
                            <th>Stage</th>
                            <th>Print Profie</th>
                        </tr>
                    </thead>

                    <tbody id="follow">

                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div id="myModal" class="modal fade">
        <div class="modal-dialog" style="width:1080px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h5 class="modal-title" style="text-align:center">Personal Details</h5>
                </div>
                <div class="modal-body" style="height:494px;overflow:auto">
                    <div class="container" style="width:inherit">
                        <div class="col-sm-4">
                            <p id="profileid"></p>
                            <p id="email"></p>
                            <p id="firstname"></p>
                            <p id="c_email"></p>
                            <p id="ca_mobile_no"></p>
                            <p id="c_state"></p>
                            <p id="address"></p>
                            <p id="age"></p>
                            <p id="height"></p>
                            <p id="complexion"></p>
                            <p id="annual_income"></p>
                            <p id="employment_type"></p>
                            <p id="highschool"></p>
                            <p id="masters"></p>
                            <p id="graduation_institute"></p>
                            <p id="fbid"></p>
                            <p id="religion"></p>
                            <p id="gotra"></p>
                            <p id="fathers_name"></p>
                            <p id="no_sisters"></p>
                            <p id="manglik"></p>
                            <p id="familyvalues"></p>
                            <p id="fathers_contact"></p>
                            <p id="fatherdetail"></p>
                            <p id="partnerage"></p>
                            <p id="partnerheight"></p>
                            <p id="partneroccupation"></p>
                            <p id="partner_family_type"></p>
                            <p id="negotiator_relation"></p>
                            <p id="ref1_name"></p>
                            <p id="ref1_contact"></p>
                        </div>
                        <div class="col-sm-4">
                            <p id="contactperson"></p>
                            <p id="mobile"></p>
                            <p id="middlename"></p>
                            <p id="c_mobile_no"></p>
                            <p id="c_address"></p>
                            <p id="c_city"></p>
                            <p id="gender"></p>
                            <p id="dob"></p>
                            <p id="weight"></p>
                            <p id="bloodgp"></p>
                            <p id="employmentstatus"></p>
                            <p id="employer_details"></p>
                            <p id="intermediate"></p>
                            <p id="masters_institute"></p>
                            <p id="otherqualification"></p>
                            <p id="linkedid"></p>
                            <p id="caste"></p>
                            <p id="mothers_name"></p>
                            <p id="brother_marital"></p>
                            <p id="rashi"></p>
                            <p id="familytype"></p>
                            <p id="aboutfather"></p>
                            <p id="mothers_contact"></p>
                            <p id="siblingdetail"></p>
                            <p id="partnercomplexion"></p>
                            <p id="partnercaste"></p>
                            <p id="partner_family_values"></p>
                            <p id="negotiator_mobile_no"></p>
                            <p id="partner_education"></p>
                            <p id="partnermoredetail"></p>


                        </div>
                        <div class="col-sm-4">
                            <p id="city"></p>
                            <p id="relation"></p>
                            <p id="lastname"></p>
                            <p id="ca_email"></p>
                            <p id="c_pincode"></p>
                            <p id="c_nationality"></p>
                            <p id="place_of_birth"></p>
                            <p id="tob"></p>
                            <p id="bodytype"></p>
                            <p id="pwd"></p>
                            <p id="employmentdetail"></p>
                            <p id="education"></p>
                            <p id="graduation"></p>
                            <p id="more_about_candidate"></p>
                            <p id="other_institute"></p>
                            <p id="mothertongue"></p>
                            <p id="maritalstatus"></p>
                            <p id="nakshatra"></p>
                            <p id="no_brothers"></p>
                            <p id="sister_marital"></p>
                            <p id="familydetail"></p>
                            <p id="aboutmother"></p>
                            <p id="motherdetail"></p>
                            <p id="partnerreligion"></p>
                            <p id="partnerbodytype"></p>
                            <p id="partner_mother_tongue"></p>
                            <p id="partnermaritalstatus"></p>
                            <p id="negotiator_name"></p>
                            <p id="negotiator_other_details"></p>
                            <p id="ref2_name"></p>
                            <p id="ref2_contact"></p>
                        </div>

                    </div>
                    <br>
                    <br>

                    <div class="container" style="width:inherit">
                        <div class="col-sm-4" id="pic1"></div>
                        <div class="col-sm-4" id="pic2"></div>
                        <div class="col-sm-4" id="pic3"></div>
                    </div>
                    <br>
                    <br>
                    <div class="container" style="width:inherit">
                        <div id="id_proof_type"></div>
                        <div id="id_proof_image" style="text-align:center"></div>

                    </div>

                    <br>
                    <br>
                </div>
                <div class="modal-header">

                    <h5 class="modal-title" style="text-align:center">Call/Walkin History</h5>
                </div>
                <div class="modal-body" style="height:494px;overflow:auto">
                    <div id="history" class="container" style="width:inherit">


                    </div>

                </div>

            </div>

        </div>
    </div>







</body>

</html>
<script>
    myappoint = function() {
        //var Today = new Date().now;
        //console.log(Today);
        var d = new Date();
        var today = d.toDateString();
        console.log(today);
        var request = new XMLHttpRequest();
        request.onreadystatechange = function() {
            if (request.readyState === XMLHttpRequest.DONE) {

                if (request.status === 200) {
                    var cw;
                    var aptcontent = '';
                    var followcontent = '';
                    var data = JSON.parse(this.responseText);
                    // console.log(data);
                    // console.log(data[0].next_followup_date);

                    var stagename = "";
                    var i = 0;
                    for (; i < data.length; i++) {
                        var m = new Date(`${data[i].contact_date}`);
                        // alert(data[i].appointment);
                        var k = new Date(`${data[i].next_followup_date}`); //imp line of date conversion
                        console.log(k);
                        switch (data[i].stage) {
                            case 0:
                                stagename = "LEAD";
                                break;
                            case 1:
                                stagename = "PROSPECT";
                                break;
                            case 2:
                                stagename = "OPPURTUNITY";
                                break;
                            case 3:
                                stagename = "VCC-3 MONTHS";
                                break;
                            case 4:
                                stagename = "VCC-6 MONTHS";
                                break;
                            case 5:
                                stagename = "VCC-12 MONTHS";
                                break;
                            case 6:
                                stagename = "VAC-3 MONTHS";
                                break;
                            case 7:
                                stagename = "VAC-6 MONTHS";
                                break;
                            default:
                                stagename = "-";
                        }
                        if (data[i].type_call_walkin === 0) {
                            cw = "Call";

                        } else {
                            cw = "Walk-in";
                        }
                        if (k.toDateString() === today) {
                            if (data[i].appointment === 1) {
                                aptcontent += `<tr><td><div class="myprofile">
                                                                                     
                                                                                          <input type="submit" class="view" value="${data[i].profile_id}" onclick="clicked('${data[i].profile_id}');">
                                                                                          </div></td><td>${cw}</td><td>${data[i].contact_no}</td><td>${m.toDateString()}</td><td><a href="/cwupdate/${data[i].profile_id}"><img src="/uploads/updatelogo.png" style="height:20px;width:20px;margin-left:50px"/></a></td><td><a href="/cwupdate/${data[i].profile_id}"><img src="/uploads/updatelogo.png" style="height:20px;width:20px;margin-left:50px"/></a></td><td>${stagename}</td><td><a href="/printprofile/${data[i].profile_id}" target="_blank">Print</a></td></tr>`;

                            } else {
                                // console.log('followup');
                                followcontent += `<tr><td><div class="myprofile">
                                                                                     
                                                                                           <input type="submit" class="view" value="${data[i].profile_id}" onclick="clicked('${data[i].profile_id}');">
                                                                                          </div></td><td>${cw}</td><td>${data[i].contact_no}</td><td>${m.toDateString()}</td><td><a href="/cwupdate/${data[i].profile_id}"><img src="/uploads/updatelogo.png" style="height:20px;width:20px;margin-left:50px"/></a></td><td><a href="/cwupdate/${data[i].profile_id}"><img src="/uploads/updatelogo.png" style="height:20px;width:20px;margin-left:50px"/></a></td><td>${stagename}</td><td><a href="/printprofile/${data[i].profile_id}" target="_blank">Print</a></td></tr>`;
                            }
                        }

                    }
                    // console.log('f content' + followcontent);
                    document.getElementById('appoint').innerHTML = aptcontent;
                    document.getElementById('follow').innerHTML = followcontent;
                } else if (request.status === 403) {
                    alert('something went wrong on the server');
                } else if (request.status === 500) {
                    alert('Something went wrong on the server');

                } else {

                    alert('Something went wrong');

                }
            }
        };
        request.open('GET', '/displayapt1', true);
        request.send(null);

    }

    function loadLoggedInUser(username) {

        document.getElementById("logout").innerHTML = `<p style = "font-size:1.5em">Hi, <span class="glyphicon glyphicon-user"><strong>${username}</strong></span></p><a href="/logout" class="btn btn-info btn-lg"><span class="glyphicon glyphicon-log-out"></span> Log out</a>`;


    }

    function clicked(item) {
        console.log('clicked');
        alert(item);
        var request = new XMLHttpRequest();

        request.onreadystatechange = function() {
            console.log('hi');
            if (request.readyState === XMLHttpRequest.DONE) {

                if (request.status === 200) {
                    console.log('hi');
                    var data = JSON.parse(this.responseText);
                    var i = 0;
                    var dob = new Date(`${data[i].date_of_birth}`);
                    document.getElementById("profileid").innerHTML = `<b>Profile Id:</b>${data[i].profile_id}`;
                    document.getElementById("email").innerHTML = `<b>Email:</b>${data[i].email}`;
                    document.getElementById("firstname").innerHTML = `<b>First Name:</b>${data[i].candidate_first_name}`;
                    document.getElementById("address").innerHTML = `<b>Address:</b>${data[i].address}`;
                    document.getElementById("tob").innerHTML = `<b>Time of Birth:</b>${data[i].time_of_birth}`;
                    document.getElementById("height").innerHTML = `<b>Height:</b>${data[i].height}`;
                    document.getElementById("pwd").innerHTML = `<b>Physically Challenged:</b>${data[i].physically_challenged}`;
                    document.getElementById("highschool").innerHTML = `<b>High School:</b>${data[i].high_school}`;
                    document.getElementById("masters").innerHTML = `<b>Masters:</b>${data[i].masters}`;
                    document.getElementById("mothertongue").innerHTML = `<b>Mother Tongue:</b>${data[i].mother_tongue}`;
                    document.getElementById("gotra").innerHTML = `<b>Gotra:</b>${data[i].gotra}`;
                    document.getElementById("manglik").innerHTML = `<b>Manglik:</b>${data[i].manglik}`;
                    document.getElementById("familytype").innerHTML = `<b>Family Type:</b>${data[i].family_type}`;
                    document.getElementById("fatherdetail").innerHTML = `<b>Father Details:</b>${data[i].details_of_father}`;
                    document.getElementById("siblingdetail").innerHTML = `<b>Sibling Details:</b>${data[i].sibling_details}`;
                    document.getElementById("partnercomplexion").innerHTML = `<b>Preferred Partner Complexion:</b>${data[i].preferred_partner_complexion}`;
                    document.getElementById("partneroccupation").innerHTML = `<b>Preferred Partner Occupation:</b>${data[i].preferred_partner_occupation}`;
                    document.getElementById("contactperson").innerHTML = `<b>Person of Contact:</b>${data[i].person_of_contact}`;
                    document.getElementById("mobile").innerHTML = `<b>Mobile:</b>${data[i].mobile_no}`;
                    document.getElementById("middlename").innerHTML = `<b>Middle Name:</b>${data[i].candidate_middle_name}`;
                    document.getElementById("city").innerHTML = `<b>City:</b>${data[i].city}`;
                    document.getElementById("dob").innerHTML = `<b>Date of Birth:</b>${dob.toDateString()}`;
                    document.getElementById("bodytype").innerHTML = `<b>Body Type:</b>${data[i].body_type}`;
                    document.getElementById("bloodgp").innerHTML = `<b>Blood Group:</b>${data[i].blood_group}`;
                    document.getElementById("employmentstatus").innerHTML = `<b>Employment Status:</b>${data[i].employment_status}`;
                    document.getElementById("intermediate").innerHTML = `<b>Intermediate:</b>${data[i].intermediate}`;
                    document.getElementById("otherqualification").innerHTML = `<b>Other Qualification:</b>${data[i].other_qualification}`;
                    document.getElementById("religion").innerHTML = `<b>Religion:</b>${data[i].religion}`;
                    document.getElementById("nakshatra").innerHTML = `<b>Nakshtra:</b>${data[i].nakshtra}`;
                    document.getElementById("familydetail").innerHTML = `<b>Family Details:</b>${data[i].details_of_family}`;
                    document.getElementById("aboutmother").innerHTML = `<b>About Mother:</b>${data[i].about_mother}`;
                    document.getElementById("partnerage").innerHTML = `<b>Preferred Partner Age:</b>${data[i].preferred_partner_age}`;
                    document.getElementById("partnerbodytype").innerHTML = `<b>Preferred Partner Body Type:</b>${data[i].preferred_partner_body_type}`;
                    document.getElementById("partnermaritalstatus").innerHTML = `<b>Preferred Partner Marital Status:</b>${data[i].preferred_partner_marital_status}`;
                    document.getElementById("partnermoredetail").innerHTML = `<b>Preferred Partner More Details:</b>${data[i].preferred_partner_more_details}`;
                    document.getElementById("gender").innerHTML = `<b>Gender:</b>${data[i].gender}`;
                    document.getElementById("linkedid").innerHTML = `<b>Linkedin Id:</b>${data[i].linkedin_id}`;
                    document.getElementById("lastname").innerHTML = `<b>Last Name:</b>${data[i].candidate_surname}`;
                    document.getElementById("relation").innerHTML = `<b>Relation with Candidate:</b>${data[i].relation_with_candidate}`;
                    document.getElementById("complexion").innerHTML = `<b>Complexion:</b>${data[i].complexion}`;
                    document.getElementById("age").innerHTML = `<b>Age:</b>${data[i].age}`;
                    document.getElementById("employmentdetail").innerHTML = `<b>Employment Details:</b>${data[i].employment_details}`;
                    document.getElementById("graduation").innerHTML = `<b>Graduation:</b>${data[i].graduation}`;
                    document.getElementById("fbid").innerHTML = `<b>Facebook Id:</b>${data[i].facebook_id}`;
                    document.getElementById("caste").innerHTML = `<b>Caste:</b>${data[i].caste}`;
                    document.getElementById("rashi").innerHTML = `<b>Rashi:</b>${data[i].rashi}`;
                    document.getElementById("maritalstatus").innerHTML = `<b>Marital Status:</b>${data[i].marital_status}`;
                    document.getElementById("familyvalues").innerHTML = `<b>Family Values:</b>${data[i].family_values}`;
                    document.getElementById("aboutfather").innerHTML = `<b>About Father:</b>${data[i].about_father}`;
                    document.getElementById("motherdetail").innerHTML = `<b>Mother Details:</b>${data[i].details_of_mother}`;
                    document.getElementById("partnerreligion").innerHTML = `<b>Preferred Partner Religion:</b>${data[i].preferred_partner_religion}`;
                    document.getElementById("partnerheight").innerHTML = `<b>Preferred Partner Height:</b>${data[i].preferred_partner_height}`;
                    document.getElementById("partnercaste").innerHTML = `<b>Preferred Partner Caste:</b>${data[i].preferred_partner_caste}`;
                    document.getElementById("pic1").innerHTML = `<img class="img-responsive" src="/uploads/${data[i].profile_pic_1}" />`;
                    document.getElementById("pic2").innerHTML = `<img class="img-responsive" src="/uploads/${data[i].profile_pic_2}" />`;
                    document.getElementById("pic3").innerHTML = `<img class="img-responsive" src="/uploads/${data[i].profile_pic_3}" />`;
                    document.getElementById("place_of_birth").innerHTML = `<b>Place of Birth:</b>${data[i].place_of_birth}`;
                    document.getElementById("weight").innerHTML = `<b>Weight:</b>${data[i].weight}`;
                    document.getElementById("education").innerHTML = `<b>Education:</b>${data[i].education}`;
                    document.getElementById("annual_income").innerHTML = `<b>Annual Incme:</b>${data[i].annual_income}`;
                    document.getElementById("more_about_candidate").innerHTML = `<b>More about Candidate:</b>${data[i].more_about_candidate}`;
                    document.getElementById("fathers_contact").innerHTML = `<b>Father's Contact:</b>${data[i].fathers_contact}`;
                    document.getElementById("mothers_contact").innerHTML = `<b>Mother's Contact:</b>${data[i].mothers_contact}`;
                    document.getElementById("partner_mother_tongue").innerHTML = `<b>Preferred Partner Mother Tongue:</b>${data[i].preferred_partner_mother_tongue}`;
                    document.getElementById("partner_family_type").innerHTML = `<b>Preferred Partner Family Type:</b>${data[i].preferred_partner_family_type}`;
                    document.getElementById("partner_family_values").innerHTML = `<b>Preferred Partner Family Values:</b>${data[i].preferred_partner_family_values}`;
                    document.getElementById("negotiator_name").innerHTML = `<b>Negotiator Name:</b>${data[i].negotiator_name}`;
                    document.getElementById("negotiator_mobile_no").innerHTML = `<b>Negotiator Mobile no:</b>${data[i].negotiator_mobile_no}`;
                    document.getElementById("negotiator_relation").innerHTML = `<b>Negotiator Relation:</b>${data[i].negotiator_relation}`;
                    document.getElementById("negotiator_other_details").innerHTML = `<b>Negotiator other details:</b>${data[i].negotiator_other_details}`;
                    document.getElementById("ref1_name").innerHTML = `<b>Reference_1 Name:</b>${data[i].ref1_name}`;
                    document.getElementById("ref1_contact").innerHTML = `<b>Reference_1 Contact:</b>${data[i].ref1_contact}`;
                    document.getElementById("ref2_name").innerHTML = `<b>Reference_2 Name:</b>${data[i].ref2_name}`;
                    document.getElementById("ref2_contact").innerHTML = `<b>Reference_2 Contact:</b>${data[i].ref2_contact}`;
                    document.getElementById("c_email").innerHTML = `<b>Candidate Email:</b>${data[i].c_email}`;
                    document.getElementById("c_mobile_no").innerHTML = `<b>Candidate Mobile:</b>${data[i].c_mobile_no}`;
                    document.getElementById("ca_email").innerHTML = `<b>Candidate Alternate Email:</b>${data[i].ca_email}`;
                    document.getElementById("ca_mobile_no").innerHTML = `<b>Candidate Alternate Mobile:</b>${data[i].ca_mobile_no}`;
                    document.getElementById("c_address").innerHTML = `<b>Candidate Address:</b>${data[i].c_address}`;
                    document.getElementById("c_pincode").innerHTML = `<b>Candidate Pincode:</b>${data[i].c_pincode}`;
                    document.getElementById("c_state").innerHTML = `<b>Candidate State:</b>${data[i].c_state}`;
                    document.getElementById("c_city").innerHTML = `<b>Candidate City:</b>${data[i].c_city}`;
                    document.getElementById("c_nationality").innerHTML = `<b>Candidate Nationality:</b>${data[i].c_nationality}`;
                    document.getElementById("graduation_institute").innerHTML = `<b>Graduation Institute:</b>${data[i].graduation_institute}`;
                    document.getElementById("masters_institute").innerHTML = `<b>Masters Institute:</b>${data[i].masters_institute}`;
                    document.getElementById("other_institute").innerHTML = `<b>Other Institute:</b>${data[i].other_institute}`;
                    document.getElementById("employer_details").innerHTML = `<b>Employer Details:</b>${data[i].employer_details}`;
                    document.getElementById("employment_type").innerHTML = `<b>Employment Type:</b>${data[i].employment_type}`;
                    document.getElementById("fathers_name").innerHTML = `<b>Father's Name:</b>${data[i].fathers_name}`;
                    document.getElementById("mothers_name").innerHTML = `<b>Mother's Name:</b>${data[i].mothers_name}`;
                    document.getElementById("no_brothers").innerHTML = `<b>No. of Brothers:</b>${data[i].no_brothers}`;
                    document.getElementById("brother_marital").innerHTML = `<b>Brother Marital Status:</b>${data[i].brother_marital}`;
                    document.getElementById("no_sisters").innerHTML = `<b>No. of Sisters:</b>${data[i].no_sisters}`;
                    document.getElementById("sister_marital").innerHTML = `<b>Sister Marital Status:</b>${data[i].sister_marital}`;
                    document.getElementById("partner_education").innerHTML = `<b>Preferred Partner Education:</b>${data[i].preferred_partner_education}`;
                    document.getElementById("id_proof_type").innerHTML = `<b>ID Proof Type:</b>${data[i].id_proof_type}`;
                    document.getElementById("id_proof_image").innerHTML = `<img class="img-responsive" src="/uploads/${data[i].id_proof_image}" />`;


                    var req = new XMLHttpRequest();
                    req.onreadystatechange = function() {
                        if (req.readyState === XMLHttpRequest.DONE) {

                            if (req.status === 200) {
                                var data = JSON.parse(this.responseText);
                                var hcontent = '';
                                var typ;
                                var apt;
                                for (i = 0; i < data.length; i++) {
                                    if (data[i].type_call_walkin === 0) {
                                        typ = "Call";
                                    } else {
                                        typ = "Walk-in";
                                    }
                                    if (data[i].appointment === 0) {
                                        apt = "No";
                                    } else {
                                        apt = "Yes";
                                    }
                                    var cdate = new Date(`${data[i].contact_date}`);
                                    var fdate = new Date(`${data[i].next_followup_date}`);
                                    hcontent += `<br><div class="col-sm-4">
                            
                            <p><b>Type:</b>${typ}</p>
                            <p><b>Contact No:</b>${data[i].contact_no}</p>
                            <p><b>Response:</b>${data[i].call_walkin_response}</p>
                            
                        </div>
                        <div class="col-sm-4">
                            <p><b>Profile Id:</b>${data[i].profile_id}</p>
                            <p><b>Call Details:</b>${data[i].call_walkin_details}</p>
                            <p><b>Follow up Date</b>${fdate.toDateString()}</p>
                            
                        </div>
                        <div class="col-sm-4">
                            <p><b>Contact Date:</b>${cdate.toDateString()}</p>
                            <p><b>Interaction Type:</b>${data[i].interaction_type}</p>
                            <p><b>Appointment:</b>${apt}</p>
                            
                        </div> <hr>`;

                                }

                                document.getElementById("history").innerHTML = hcontent;
                                $("#myModal").modal('show');
                                //Yahan pe isliye kar rahe hain kyunki dono ek saath complete hoga tab popup open hoga      
                            } else if (req.status === 403) {
                                alert('something went wrong on the server');
                            } else if (req.status === 500) {
                                alert('Something went wrong on the server');

                            } else {

                                alert('Something went wrong');

                            }
                        }
                    };
                    req.open('GET', `/callhistory/${item}`, true);
                    req.send(null);


                } else if (request.status === 403) {
                    alert('something went wrong on the server');
                } else if (request.status === 500) {
                    alert('Something went wrong on the server');

                } else {

                    alert('Something went wrong');

                }
            }
        };
        request.open('GET', `/user_details/${item}`, true);
        request.send(null);
    }

    function leads() {
        var request = new XMLHttpRequest();
        request.onreadystatechange = function() {
            if (request.readyState === XMLHttpRequest.DONE) {
                if (request.status === 200) {
                    var l = this.responseText;
                    document.getElementById("countleads").innerHTML = l;


                }

            }
        };

        request.open('GET', '/leadscount', true);
        request.send(null);


    }

    function callin() {
        var request = new XMLHttpRequest();
        request.onreadystatechange = function() {
            if (request.readyState === XMLHttpRequest.DONE) {
                if (request.status === 200) {
                    var l = this.responseText;
                    document.getElementById("no_of_callin").innerHTML = l;


                }

            }
        };

        request.open('GET', '/no_of_callins', true);
        request.send(null);


    }
    callin();

    function walkin() {
        var request = new XMLHttpRequest();
        request.onreadystatechange = function() {
            if (request.readyState === XMLHttpRequest.DONE) {
                if (request.status === 200) {
                    var l = this.responseText;
                    document.getElementById("no_of_walkin").innerHTML = l;


                }

            }
        };

        request.open('GET', '/no_of_walkins', true);
        request.send(null);


    }
    walkin();

    function paid_m() {
        var request = new XMLHttpRequest();
        request.onreadystatechange = function() {
            if (request.readyState === XMLHttpRequest.DONE) {
                if (request.status === 200) {
                    var l = this.responseText;
                    document.getElementById("paid_members").innerHTML = l;


                }

            }
        };

        request.open('GET', '/no_of_paidmembers', true);
        request.send(null);


    }

    function prospects() {
        var request = new XMLHttpRequest();
        request.onreadystatechange = function() {
            if (request.readyState === XMLHttpRequest.DONE) {
                if (request.status === 200) {
                    var p = this.responseText;
                    document.getElementById("countprospects").innerHTML = p;


                }

            }
        };

        request.open('GET', '/prospectscount', true);
        request.send(null);

    }
    paid_m();

    function loadLogin() {
        // Check if the user is already logged in
        var request = new XMLHttpRequest();
        request.onreadystatechange = function() {
            if (request.readyState === XMLHttpRequest.DONE) {
                if (request.status === 200) {
                    loadLoggedInUser(this.responseText);

                }

            }
        };

        request.open('GET', '/check-login', true);
        request.send(null);
    }
    loadLogin();
    leads();
    prospects();
    myappoint();
</script>